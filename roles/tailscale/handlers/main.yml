---
# Tailscale Service Handlers
# Handlers for Tailscale service restarts and systemd reload

- name: Reload systemd
  ansible.builtin.systemd_service:
      daemon_reload: true
  become: true
  listen: reload systemd

- name: Restart tailscaled
  ansible.builtin.systemd_service:
      name: tailscaled
      state: restarted
      daemon_reload: true
  become: true
  listen: restart tailscaled

- name: Reload tailscale config
  ansible.builtin.command:
      cmd: tailscale debug reload-config
  become: true
  listen: reload tailscale config
  changed_when: true

- name: Refresh ansible facts
  ansible.builtin.setup:
      filter: ansible_local
  listen: refresh ansible facts
